{% extends "base.html" %}{% set admin_area=True %}
{% block title %}Attraction Event{% endblock %}

{% block content %}
<style type="text/css">
  form {
    max-width: 738px;
    margin-bottom: 120px;
  }

  h2 {
    margin-bottom: 30px;
  }

  .dropdown-menu > li > a {
    padding: 0;
  }

  .dropdown-menu > li > a > input {
    background-color: transparent;
    border: 0 none transparent;
    color: #333;
    margin: 0;
    padding: 3px 20px;
  }
</style>

<h2>
  {%- if event.is_new -%}
    <span class="glyphicon glyphicon-plus"></span> New event for the {{ attraction|form_link }} attraction
  {%- else -%}
    <span class="glyphicon glyphicon-cog"></span> Edit the {{ event.feature.name }} event for the {{ attraction|form_link }} attraction
  {%- endif -%}
</h2>

<form method="post" action="event" class="form-horizontal" role="form">
  {{ csrf_token() }}
  <input type="hidden" name="id" value="{{ 'None' if event.is_new else event.id }}" />
  <input type="hidden" name="attraction_id" value="{{ attraction.id }}">
  <div class="form-group">
    <label class="col-sm-3 control-label">Feature</label>
    <div class="col-sm-6">
      {% if feature %}
        <div class="form-control-static">{{ feature.name }}</div>
        <input type="hidden" name="attraction_feature_id" value="{{ feature.id }}">
      {% else %}
        <select name="attraction_feature_id" class="form-control">
          {{ options(attraction.feature_opts, event.attraction_feature_id) }}
        </select>
      {% endif %}
    </div>
  </div>
  <div class="form-group">
    <label class="col-sm-3 control-label">Location</label>
    <div class="col-sm-6">
      <select name="location" class="form-control">
        {% set used_location_opts = attraction.used_location_opts %}
        {% if used_location_opts %}
          {{ options(used_location_opts, event.location) }}
          <option disabled="disabled">––––––––––</option>
        {% endif %}
        {{ options(attraction.unused_location_opts, event.location) }}
      </select>
    </div>
  </div>
  <div class="form-group">
    <label class="col-sm-3 control-label">Start Time</label>
    <div class="col-sm-6">
      <select name="start_time" class="form-control">
        {% for day, opts in attraction.start_time_opts_by_day.items() %}
          <optgroup label="{{ day }}">
            {{ options(opts, event.start_time) }}
          </optgroup>
        {% endfor %}
      </select>
    </div>
  </div>
  <div class="form-group">
    <label class="col-sm-3 control-label">Duration</label>
    <div class="col-sm-6">
      <select name="duration" class="form-control">
        {{ options(attraction.duration_opts, event.duration) }}
      </select>
    </div>
  </div>
  <div class="form-group">
    <label class="col-sm-3 control-label">Slots</label>
    <div class="col-sm-6">
      <input name="slots" value="{{ event.slots }}" class="form-control" type="number" required="required" min="1">
    </div>
    <div class="clearfix"></div>
    <div class="col-sm-offset-3 col-sm-9 help-block">
      How many attendees can participate in this event at the same time?
    </div>
  </div>
  <div class="form-group">
    <div class="col-sm-9 col-sm-offset-3">
      <input type="submit" name="save" class="btn btn-primary" value="Save">
      <div class="btn-group">
        <button type="submit" name="save_another_0" class="btn btn-primary">Save & Add Another</button>
        <button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          <span class="caret"></span>
          <span class="sr-only">Toggle Dropdown</span>
        </button>
        <ul class="dropdown-menu">
          <li><a href="#"><input type="submit" name="save_another_900" value="After 15 minute break"></a></li>
          <li><a href="#"><input type="submit" name="save_another_1800" value="After 30 minute break"></a></li>
          <li><a href="#"><input type="submit" name="save_another_2700" value="After 45 minute break"></a></li>
          <li><a href="#"><input type="submit" name="save_another_3600" value="After 1 hour break"></a></li>
        </ul>
      </div>
      <a href="form?id={{ attraction.id }}" type="button" class="btn btn-default">Cancel</a>
    </div>
  </div>
</form>
{% endblock %}
